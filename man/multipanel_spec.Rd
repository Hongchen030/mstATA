% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multipanel_spec.R
\name{multipanel_spec}
\alias{multipanel_spec}
\title{Assemble a multi-panel ATA model}
\usage{
multipanel_spec(
  x,
  panel_model,
  num_panels,
  solution_con = NULL,
  global_min_use = 0,
  global_max_use = Inf,
  item_min_use = NULL,
  item_max_use = NULL
)
}
\arguments{
\item{x}{An object of class \code{"mstATA_design"} created by \code{mst_design()}.}

\item{panel_model}{An object of class \code{"mstATA_model"} created by \code{onepanel_spec()}.}

\item{num_panels}{Integer. Number of panels to be assembled.}

\item{solution_con}{Optional list of \code{mstATA_constraint} objects defining
solution-level requirements across panels (e.g., unique
item/stimulus counts across panels, unique item/stimulus counts from specific categories
across panels).}

\item{global_min_use}{Scalar. Minimum number of times any item may be used
across panels. Default = \code{0}.}

\item{global_max_use}{Scalar. Maximum number of times any item may be used
across panels. Default = \code{Inf}.}

\item{item_min_use}{Optional data frame with columns \code{item_id} and
\code{min}, specifying item-specific minimum reuse counts.}

\item{item_max_use}{Optional data frame with columns \code{item_id} and
\code{max}, specifying item-specific maximum reuse counts.}
}
\value{
An object of class \code{"mstATA_model"}, represented as a named list
containing constraint matrices, objective coefficients, decision variable
metadata, bounds, and optimization sense.
\describe{
\item{name}{A character vector indicating the specifications in each row of \code{A_binary}}
\item{specification}{A \code{data.frame} summarizing the constraint specification, including
the requirement name, attribute, constraint type, application level,
operator, and the number of constraint rows generated.}
\item{A_binary}{A sparse constraint matrix (class \code{"Matrix"}) for binary
decision variables. Rows correspond to constraints; columns correspond to
binary decision variables.}
\item{A_real}{A sparse constraint matrix (class \code{"Matrix"}) for
continuous decision variables. Must have the same number of rows as
\code{A_binary}.}
\item{A}{Constraint coefficient matrix (sparse or dense).}
\item{C_binary}{A numeric vector of objective coefficients for binary decision
variables.}
\item{C_real}{A numeric vector of objective coefficients for continuous
decision variables.}
\item{obj}{Objective function coefficient vector.}
\item{d}{Right-hand-side vector of constraints.}
\item{operators}{Constraint operators (e.g., \code{"<="}, \code{">="}, \code{"="}).}
\item{vtype}{Decision variable types (\code{"B"} for binary, \code{"C"} for continuous).}
\item{varname}{Decision variable names.}
\item{lb}{Lower bounds for decision variables.}
\item{ub}{Upper bounds for decision variables.}
\item{sense}{Optimization sense (\code{"min"} or \code{"max"}).}
}
}
\description{
Constructs a \strong{multi-panel ATA model} by expanding
single-panel specifications to multiple panels and
turning it into a solver-ready formulation.

Solution-level constraints and decision-variable linking between
item-module-panel variables and solution-level variables are handled at this stage.
}
\details{
\strong{1. Parallel Panels}

The single-panel specification is
expanded to \code{num_panels} panels by replicating constraint matrices
in a block-diagonal structure. All panels share identical constraints
and objectives.

Solution-level constraints, if provided, are appended after panel expansion.

\strong{Specification traceability}

The returned model contains an expanded specification table that records,
for each requirement:
\itemize{
\item the originating panel,
\item the number of constraints generated,
\item the contiguous row ranges in the final solver matrix.
}

This information can be used to diagnose infeasibility and to prioritize
or relax groups of constraints programmatically.

\strong{2. Consistency between item-module-panel selection and solution-level item indicators}

The decision-variable linking constraints (e.g., \code{dvlink_item_solution})
are automatically added to link item-module-panel selection and solution-level
item selection.

The constraint enforces:

\strong{
Each item can be used at least a specified minimum number of times and/or
no more than a specified maximum number of times across all panels.
}

Key characteristics:

\itemize{
\item Attribute: \emph{itemset level (item-itself set)} \emph{logical} (if selected, then increment reuse).
\item Constraints are applied at the \strong{"Solution-level"}.
}

Global reuse limits are supplied via \code{global_min_use} and
\code{global_max_use}. These bounds apply to all items unless overridden.

Item-specific reuse limits may be supplied through:
\itemize{
\item \code{item_min_use}: a data frame with columns \code{item_id} and \code{min}
\item \code{item_max_use}: a data frame with columns \code{item_id} and \code{max}
}

The total number of constraints generated is always
\eqn{2 \times \text{PoolSize}}, corresponding to one minimum and one maximum
constraint per item.
}
\seealso{
\code{\link[=onepanel_spec]{onepanel_spec()}}
}
